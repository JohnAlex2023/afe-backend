{"openapi":"3.1.0","info":{"title":"AFE Backend","description":"Backend empresarial para gestión de facturas y proveedores","contact":{"name":"Equipo Backend","email":"soporte@empresa.com"},"license":{"name":"MIT"},"version":"1.0.0"},"paths":{"/api/v1/":{"get":{"tags":["Root"],"summary":"Read Root","operationId":"read_root_api_v1__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/auth/login":{"post":{"tags":["Auth"],"summary":"Login con usuario y contraseña","description":"Endpoint de login. Retorna JWT token y datos del usuario.","operationId":"login_api_v1_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/responsables/":{"get":{"tags":["Responsables","Responsables"],"summary":"Listar responsables","description":"Obtiene todos los responsables registrados.","operationId":"list_responsables_api_v1_responsables__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/ResponsableRead"},"type":"array","title":"Response List Responsables Api V1 Responsables  Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]},"post":{"tags":["Responsables","Responsables"],"summary":"Crear responsable","description":"Crea un nuevo usuario responsable en el sistema.","operationId":"create_responsable_endpoint_api_v1_responsables__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponsableCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponsableRead"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/responsables/{responsable_id}/proveedores":{"get":{"tags":["Responsables","Responsables"],"summary":"Listar proveedores asignados a un responsable","operationId":"listar_proveedores_por_responsable_api_v1_responsables__responsable_id__proveedores_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"responsable_id","in":"path","required":true,"schema":{"type":"integer","title":"Responsable Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Responsables","Responsables"],"summary":"Actualizar NITs asignados a un responsable","description":"Actualiza la lista de NITs de proveedores asignados a un responsable. La asignación es idempotente: activa los NITs enviados y desactiva los que ya no estén.","operationId":"actualizar_proveedores_responsable_api_v1_responsables__responsable_id__proveedores_put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"responsable_id","in":"path","required":true,"schema":{"type":"integer","title":"Responsable Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponsableProveedorUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/responsables/proveedor/{proveedor_id}/responsables":{"get":{"tags":["Responsables","Responsables"],"summary":"Listar responsables asignados a un proveedor","operationId":"listar_responsables_por_proveedor_api_v1_responsables_proveedor__proveedor_id__responsables_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"proveedor_id","in":"path","required":true,"schema":{"type":"integer","title":"Proveedor Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/responsables/{responsable_id}/proveedores/{proveedor_id}":{"delete":{"tags":["Responsables","Responsables"],"summary":"Desactivar relación responsable-proveedor","operationId":"desactivar_relacion_responsable_proveedor_api_v1_responsables__responsable_id__proveedores__proveedor_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"responsable_id","in":"path","required":true,"schema":{"type":"integer","title":"Responsable Id"}},{"name":"proveedor_id","in":"path","required":true,"schema":{"type":"integer","title":"Proveedor Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/responsables/{responsable_id}/proveedores/{proveedor_id}/eliminar":{"delete":{"tags":["Responsables","Responsables"],"summary":"Eliminar completamente la relación responsable-proveedor","description":"Elimina la fila de la relación responsable-proveedor de la base de datos.","operationId":"eliminar_relacion_responsable_proveedor_api_v1_responsables__responsable_id__proveedores__proveedor_id__eliminar_delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"responsable_id","in":"path","required":true,"schema":{"type":"integer","title":"Responsable Id"}},{"name":"proveedor_id","in":"path","required":true,"schema":{"type":"integer","title":"Proveedor Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/responsables/asignar-proveedores":{"post":{"tags":["Responsables","Responsables"],"summary":"Asignar proveedores a responsable","description":"Asigna uno o varios proveedores (por NIT) a un responsable.","operationId":"asignar_proveedores_endpoint_api_v1_responsables_asignar_proveedores_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponsableProveedorAssign"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/responsables/{id}":{"put":{"tags":["Responsables","Responsables"],"summary":"Actualizar responsable","description":"Actualiza los datos de un responsable por su ID.","operationId":"update_responsable_endpoint_api_v1_responsables__id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","title":"Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponsableUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponsableRead"}}}},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}},"description":"Not Found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Responsables","Responsables"],"summary":"Eliminar responsable","description":"Elimina un responsable por su ID.","operationId":"delete_responsable_endpoint_api_v1_responsables__id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","title":"Id"}}],"responses":{"204":{"description":"Successful Response"},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}},"description":"Not Found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/clientes/":{"get":{"tags":["Clientes","Clientes"],"summary":"Listar clientes","description":"Obtiene una lista paginada de clientes registrados en el sistema.","operationId":"list_all_api_v1_clientes__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ClienteRead"},"title":"Response List All Api V1 Clientes  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Clientes","Clientes"],"summary":"Crear cliente","description":"Registra un nuevo cliente en el sistema.","operationId":"create_api_v1_clientes__post","security":[{"OAuth2PasswordBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClienteBase"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClienteRead"}}}},"400":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}},"description":"Bad Request"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/clientes/{cliente_id}":{"get":{"tags":["Clientes","Clientes"],"summary":"Obtener cliente","description":"Devuelve los datos de un cliente específico.","operationId":"get_one_api_v1_clientes__cliente_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"cliente_id","in":"path","required":true,"schema":{"type":"integer","title":"Cliente Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClienteRead"}}}},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}},"description":"Not Found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/proveedores/":{"get":{"tags":["Proveedores","Proveedores"],"summary":"Listar proveedores","description":"Obtiene una lista paginada de proveedores.","operationId":"list_all_api_v1_proveedores__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ProveedorRead"},"title":"Response List All Api V1 Proveedores  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Proveedores","Proveedores"],"summary":"Crear proveedor","description":"Registra un nuevo proveedor en el sistema.","operationId":"create_api_v1_proveedores__post","security":[{"OAuth2PasswordBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProveedorBase"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProveedorRead"}}}},"400":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}},"description":"Bad Request"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/proveedores/{proveedor_id}":{"get":{"tags":["Proveedores","Proveedores"],"summary":"Obtener proveedor","description":"Devuelve los datos de un proveedor específico por ID.","operationId":"get_one_api_v1_proveedores__proveedor_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"proveedor_id","in":"path","required":true,"schema":{"type":"integer","title":"Proveedor Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProveedorRead"}}}},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}},"description":"Not Found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Proveedores","Proveedores"],"summary":"Actualizar proveedor","description":"Actualiza los datos de un proveedor por su ID.","operationId":"update_api_v1_proveedores__proveedor_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"proveedor_id","in":"path","required":true,"schema":{"type":"integer","title":"Proveedor Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProveedorBase"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProveedorRead"}}}},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}},"description":"Not Found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Proveedores","Proveedores"],"summary":"Eliminar proveedor","description":"Elimina un proveedor por su ID.","operationId":"delete_api_v1_proveedores__proveedor_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"proveedor_id","in":"path","required":true,"schema":{"type":"integer","title":"Proveedor Id"}}],"responses":{"204":{"description":"Successful Response"},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}},"description":"Not Found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/roles/":{"get":{"tags":["Roles","Roles y Permisos"],"summary":"Listar roles","description":"Obtiene la lista de roles disponibles en el sistema.","operationId":"list_all_api_v1_roles__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/app__schemas__role__RoleRead"},"type":"array","title":"Response List All Api V1 Roles  Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/facturas/cursor":{"get":{"tags":["Facturas","Facturas"],"summary":"Listar facturas con cursor (scroll infinito)","description":"Endpoint optimizado para grandes volúmenes (10k+ facturas). Usa cursor-based pagination para performance constante O(1).","operationId":"list_with_cursor_api_v1_facturas_cursor_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":500,"title":"Limit"}},{"name":"cursor","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Cursor"}},{"name":"nit","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Nit"}},{"name":"numero_factura","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Numero Factura"}},{"name":"solo_asignadas","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Solo Asignadas"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CursorPaginatedResponse_FacturaRead_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/all":{"get":{"tags":["Facturas","Facturas"],"summary":"Obtener TODAS las facturas (Dashboard administrativo)","description":"Retorna todas las facturas sin límites de paginación. Exclusivo para dashboards administrativos que requieren vista completa del sistema.","operationId":"list_all_for_dashboard_api_v1_facturas_all_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"solo_asignadas","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Solo Asignadas"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/FacturaRead"},"title":"Response List All For Dashboard Api V1 Facturas All Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/":{"get":{"tags":["Facturas","Facturas"],"summary":"Listar facturas con paginación","description":"Obtiene facturas con metadata de paginación empresarial. Admin puede ver todas o solo asignadas, Responsable solo sus proveedores.","operationId":"list_all_api_v1_facturas__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1,"title":"Page"}},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":500,"title":"Per Page"}},{"name":"nit","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Nit"}},{"name":"numero_factura","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Numero Factura"}},{"name":"solo_asignadas","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Solo Asignadas"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedResponse_FacturaRead_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Facturas","Facturas"],"summary":"Crear o actualizar factura","description":"Procesa una nueva factura. Si ya existe, devuelve un error de conflicto.","operationId":"create_invoice_api_v1_facturas__post","security":[{"OAuth2PasswordBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FacturaCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FacturaRead"}}}},"409":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}},"description":"Conflict"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/{factura_id}":{"get":{"tags":["Facturas","Facturas"],"summary":"Obtener factura por ID","description":"Devuelve los datos de una factura específica por ID.","operationId":"get_one_api_v1_facturas__factura_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"factura_id","in":"path","required":true,"schema":{"type":"integer","title":"Factura Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FacturaRead"}}}},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}},"description":"Not Found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/nit/{nit}":{"get":{"tags":["Facturas","Facturas"],"summary":"Listar facturas por NIT","description":"Obtiene todas las facturas asociadas a un proveedor por NIT con paginación.","operationId":"get_by_nit_api_v1_facturas_nit__nit__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"nit","in":"path","required":true,"schema":{"type":"string","title":"Nit"}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1,"title":"Page"}},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":500,"title":"Per Page"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedResponse_FacturaRead_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/cufe/{cufe}":{"get":{"tags":["Facturas","Facturas"],"summary":"Obtener factura por CUFE","description":"Devuelve una factura única usando el CUFE.","operationId":"get_by_cufe_api_v1_facturas_cufe__cufe__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"cufe","in":"path","required":true,"schema":{"type":"string","title":"Cufe"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FacturaRead"}}}},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}},"description":"Not Found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/numero/{numero_factura}":{"get":{"tags":["Facturas","Facturas"],"summary":"Obtener factura por número de factura","description":"Devuelve una factura única usando el número de factura.","operationId":"get_by_numero_api_v1_facturas_numero__numero_factura__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"numero_factura","in":"path","required":true,"schema":{"type":"string","title":"Numero Factura"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FacturaRead"}}}},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}},"description":"Not Found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/{factura_id}/aprobar":{"post":{"tags":["Facturas","Facturas"],"summary":"Aprobar factura","description":"Aprueba una factura cambiando su estado a 'aprobado'","operationId":"aprobar_factura_api_v1_facturas__factura_id__aprobar_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"factura_id","in":"path","required":true,"schema":{"type":"integer","title":"Factura Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Payload"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FacturaRead"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/{factura_id}/rechazar":{"post":{"tags":["Facturas","Facturas"],"summary":"Rechazar factura","description":"Rechaza una factura cambiando su estado a 'rechazado'","operationId":"rechazar_factura_api_v1_facturas__factura_id__rechazar_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"factura_id","in":"path","required":true,"schema":{"type":"integer","title":"Factura Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Payload"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FacturaRead"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/periodos/resumen":{"get":{"tags":["Facturas","Facturas","Reportes - Períodos Mensuales"],"summary":"Resumen de facturas por mes","description":"Obtiene un resumen de facturas agrupadas por mes/año con totales agregados. Ideal para dashboards y reportes mensuales.","operationId":"get_resumen_por_mes_api_v1_facturas_periodos_resumen_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"año","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Año"}},{"name":"proveedor_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Proveedor Id"}},{"name":"estado","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Estado"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/periodos/{periodo}":{"get":{"tags":["Facturas","Facturas","Reportes - Períodos Mensuales"],"summary":"Facturas de un período específico","description":"Obtiene todas las facturas de un mes/año específico (formato: YYYY-MM) con paginación","operationId":"get_facturas_periodo_api_v1_facturas_periodos__periodo__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"periodo","in":"path","required":true,"schema":{"type":"string","title":"Periodo"}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1,"title":"Page"}},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":500,"title":"Per Page"}},{"name":"proveedor_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Proveedor Id"}},{"name":"estado","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Estado"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedResponse_FacturaRead_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/periodos/{periodo}/estadisticas":{"get":{"tags":["Facturas","Facturas","Reportes - Períodos Mensuales"],"summary":"Estadísticas de un período","description":"Obtiene estadísticas detalladas de un período específico incluyendo desglose por estado","operationId":"get_stats_periodo_api_v1_facturas_periodos__periodo__estadisticas_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"periodo","in":"path","required":true,"schema":{"type":"string","title":"Periodo"}},{"name":"proveedor_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Proveedor Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/periodos/{periodo}/count":{"get":{"tags":["Facturas","Facturas","Reportes - Períodos Mensuales"],"summary":"Contar facturas de un período","description":"Retorna el número total de facturas en un período","operationId":"count_periodo_api_v1_facturas_periodos__periodo__count_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"periodo","in":"path","required":true,"schema":{"type":"string","title":"Periodo"}},{"name":"proveedor_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Proveedor Id"}},{"name":"estado","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Estado"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/periodos/años/disponibles":{"get":{"tags":["Facturas","Facturas","Reportes - Períodos Mensuales"],"summary":"Años con facturas","description":"Retorna lista de años que tienen facturas registradas","operationId":"get_años_api_v1_facturas_periodos_años_disponibles_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/facturas/periodos/jerarquia":{"get":{"tags":["Facturas","Facturas","Reportes - Períodos Mensuales"],"summary":"Vista jerárquica año→mes→facturas","description":"Retorna facturas organizadas jerárquicamente por año y mes. Ideal para dashboards con drill-down.","operationId":"get_jerarquia_api_v1_facturas_periodos_jerarquia_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"año","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Año"}},{"name":"mes","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Mes"}},{"name":"proveedor_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Proveedor Id"}},{"name":"estado","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Estado"}},{"name":"limit_por_mes","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit Por Mes"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/export/csv":{"get":{"tags":["Facturas","Facturas","Exportación"],"summary":"Exportar facturas a CSV","description":"Genera archivo CSV con todas las facturas filtradas. Ideal para reportes y análisis en Excel.","operationId":"export_to_csv_api_v1_facturas_export_csv_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"fecha_desde","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Fecha inicial (YYYY-MM-DD)","title":"Fecha Desde"},"description":"Fecha inicial (YYYY-MM-DD)"},{"name":"fecha_hasta","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Fecha final (YYYY-MM-DD)","title":"Fecha Hasta"},"description":"Fecha final (YYYY-MM-DD)"},{"name":"nit","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Nit"}},{"name":"estado","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Estado"}},{"name":"solo_asignadas","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Solo Asignadas"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/facturas/export/metadata":{"get":{"tags":["Facturas","Facturas","Exportación"],"summary":"Obtener metadata de exportación","description":"Retorna información sobre el dataset a exportar (total registros, rangos, etc.)","operationId":"get_export_info_api_v1_facturas_export_metadata_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"fecha_desde","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Fecha inicial (YYYY-MM-DD)","title":"Fecha Desde"},"description":"Fecha inicial (YYYY-MM-DD)"},{"name":"fecha_hasta","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Fecha final (YYYY-MM-DD)","title":"Fecha Hasta"},"description":"Fecha final (YYYY-MM-DD)"},{"name":"solo_asignadas","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Solo Asignadas"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/automation/inicializar-sistema":{"post":{"tags":["Automatización","Automatización"],"summary":"🚀 Inicialización Enterprise del Sistema Completo","description":"**INICIALIZACIÓN COMPLETA DEL SISTEMA ENTERPRISE**\n\nEjecuta la inicialización orquestada de todo el sistema:\n\n1. ✅ **Verificación de Estado**: Analiza el estado actual\n2. ✅ **Validación de Pre-requisitos**: Valida datos y configuraciones\n3. ✅ **Importación de Presupuesto**: Importa desde Excel (si se proporciona)\n4. ✅ **Auto-configuración NIT-Responsable**: Crea asignaciones automáticamente\n5. ✅ **Vinculación de Facturas**: Vincula facturas existentes con presupuesto\n6. ✅ **Activación de Workflow**: Activa workflow de aprobación\n7. ✅ **Reporte Ejecutivo**: Genera reporte completo\n\n**Características Enterprise:**\n- Transacciones atómicas (todo o nada)\n- Rollback automático en errores\n- Idempotente (se puede ejecutar múltiples veces)\n- Logging detallado\n- Dry-run para simulación\n\n**Parámetros:**\n- `archivo_presupuesto`: Ruta al Excel de presupuesto (opcional)\n- `año_fiscal`: Año a procesar (default: 2025)\n- `responsable_default_id`: ID del responsable por defecto\n- `ejecutar_vinculacion`: Si debe vincular facturas (default: true)\n- `ejecutar_workflow`: Si debe activar workflow (default: true)\n- `dry_run`: Si true, solo simula sin hacer cambios (default: false)\n\n**Ejemplo de uso:**\n```bash\n# Simular (dry-run)\nPOST /api/v1/automation/inicializar-sistema?dry_run=true\n\n# Ejecutar completo\nPOST /api/v1/automation/inicializar-sistema?archivo_presupuesto=presupuesto.xlsx\n```","operationId":"inicializar_sistema_completo_api_v1_automation_inicializar_sistema_post","parameters":[{"name":"archivo_presupuesto","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Archivo Presupuesto"}},{"name":"año_fiscal","in":"query","required":false,"schema":{"type":"integer","default":2025,"title":"Año Fiscal"}},{"name":"responsable_default_id","in":"query","required":false,"schema":{"type":"integer","default":1,"title":"Responsable Default Id"}},{"name":"ejecutar_vinculacion","in":"query","required":false,"schema":{"type":"boolean","default":true,"title":"Ejecutar Vinculacion"}},{"name":"ejecutar_workflow","in":"query","required":false,"schema":{"type":"boolean","default":true,"title":"Ejecutar Workflow"}},{"name":"dry_run","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Dry Run"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/automation/procesar":{"post":{"tags":["Automatización","Automatización"],"summary":"Procesar Facturas Pendientes","description":"Ejecuta el procesamiento automático de facturas pendientes.\n\nEsta operación puede tomar varios minutos dependiendo de la cantidad\nde facturas pendientes.","operationId":"procesar_facturas_pendientes_api_v1_automation_procesar_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SolicitudProcesamiento"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Procesar Facturas Pendientes Api V1 Automation Procesar Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/automation/estadisticas":{"get":{"tags":["Automatización","Automatización"],"summary":"Obtener Estadisticas Automatizacion","description":"Obtiene estadísticas del sistema de automatización.","operationId":"obtener_estadisticas_automatizacion_api_v1_automation_estadisticas_get","parameters":[{"name":"dias_atras","in":"query","required":false,"schema":{"type":"integer","maximum":90,"minimum":1,"default":7,"title":"Dias Atras"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EstadisticasAutomatizacion"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/automation/facturas-procesadas":{"get":{"tags":["Automatización","Automatización"],"summary":"Obtener Facturas Procesadas","description":"Obtiene la lista de facturas procesadas automáticamente.","operationId":"obtener_facturas_procesadas_api_v1_automation_facturas_procesadas_get","parameters":[{"name":"dias_atras","in":"query","required":false,"schema":{"type":"integer","maximum":90,"minimum":1,"default":7,"title":"Dias Atras"}},{"name":"estado","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Estado"}},{"name":"proveedor_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Proveedor Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"default":50,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ResultadoFacturaAutomatizada"},"title":"Response Obtener Facturas Procesadas Api V1 Automation Facturas Procesadas Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/automation/configuracion":{"get":{"tags":["Automatización","Automatización"],"summary":"Obtener Configuracion","description":"Obtiene la configuración actual del sistema de automatización.","operationId":"obtener_configuracion_api_v1_automation_configuracion_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Obtener Configuracion Api V1 Automation Configuracion Get"}}}}}},"put":{"tags":["Automatización","Automatización"],"summary":"Actualizar Configuracion","description":"Actualiza la configuración del sistema de automatización.","operationId":"actualizar_configuracion_api_v1_automation_configuracion_put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/app__api__v1__routers__automation__ConfiguracionAutomatizacion"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/automation/reprocesar/{factura_id}":{"post":{"tags":["Automatización","Automatización"],"summary":"Reprocesar Factura","description":"Reprocesa una factura específica con el sistema de automatización.","operationId":"reprocesar_factura_api_v1_automation_reprocesar__factura_id__post","parameters":[{"name":"factura_id","in":"path","required":true,"schema":{"type":"integer","title":"Factura Id"}},{"name":"modo_debug","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Modo Debug"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/automation/patrones/{proveedor_id}":{"get":{"tags":["Automatización","Automatización"],"summary":"Analizar Patrones Proveedor","description":"Analiza los patrones de facturación de un proveedor específico.","operationId":"analizar_patrones_proveedor_api_v1_automation_patrones__proveedor_id__get","parameters":[{"name":"proveedor_id","in":"path","required":true,"schema":{"type":"integer","title":"Proveedor Id"}},{"name":"dias_atras","in":"query","required":false,"schema":{"type":"integer","maximum":365,"minimum":30,"default":90,"title":"Dias Atras"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/automation/notificar-resumen":{"post":{"tags":["Automatización","Automatización"],"summary":"Enviar Notificacion Resumen Manual","description":"Envía manualmente un resumen de procesamiento a los responsables.","operationId":"enviar_notificacion_resumen_manual_api_v1_automation_notificar_resumen_post","parameters":[{"name":"dias_atras","in":"query","required":false,"schema":{"type":"integer","maximum":7,"minimum":1,"default":1,"title":"Dias Atras"}}],"requestBody":{"content":{"application/json":{"schema":{"anyOf":[{"type":"array","items":{"type":"integer"}},{"type":"null"}],"title":"Responsables Ids"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/automatizacion/procesar":{"post":{"tags":["Automatización - Mes Anterior","Automatización"],"summary":"Procesar Facturas Automaticamente","description":"🤖 Ejecuta el procesamiento automático de facturas pendientes.\n\nEste endpoint procesa facturas en estado 'en_revision' o 'pendiente'\ny las aprueba automáticamente si cumplen con los criterios de comparación\ncon el mes anterior.\n\n**Criterios de aprobación automática:**\n- Existe factura del mismo proveedor y concepto en el mes anterior\n- Diferencia de monto <= tolerancia_porcentaje (default 5%)\n- Factura del mes anterior está aprobada\n\n**Parámetros configurables:**\n- `tolerancia_porcentaje`: % de diferencia permitida (default: 5%)\n- `limite_facturas`: Máximo de facturas a procesar (default: 50)\n- `modo_debug`: Incluir información detallada (default: false)\n\n**Respuesta:**\n```json\n{\n    \"success\": true,\n    \"message\": \"Procesadas 45 facturas. 12 aprobadas automáticamente.\",\n    \"data\": {\n        \"facturas_procesadas\": 45,\n        \"aprobadas_automaticamente\": 12,\n        \"enviadas_revision\": 33,\n        \"errores\": 0,\n        \"tasa_automatizacion\": 26.67,\n        \"detalle_facturas\": [...]\n    }\n}\n```\n\n**Logs de auditoría:**\nTodas las decisiones quedan registradas en el sistema de auditoría\ncon información completa sobre el motivo de aprobación/rechazo.","operationId":"procesar_facturas_automaticamente_api_v1_automatizacion_procesar_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/app__api__v1__routers__automatizacion__ConfiguracionAutomatizacion","default":{"tolerancia_porcentaje":5.0,"limite_facturas":50,"modo_debug":false}}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/automatizacion/estadisticas":{"get":{"tags":["Automatización - Mes Anterior","Automatización"],"summary":"Obtener Estadisticas Automatizacion","description":"📊 Obtiene estadísticas de automatización de los últimos N días.\n\n**Métricas incluidas:**\n- Total de facturas procesadas automáticamente\n- Tasa de aprobación automática\n- Tasa de precisión (aprobaciones correctas)\n- Distribución por método de decisión\n- Proveedores con mayor automatización\n\n**Respuesta:**\n```json\n{\n    \"periodo\": {\"desde\": \"2025-09-08\", \"hasta\": \"2025-10-08\", \"dias\": 30},\n    \"totales\": {\n        \"procesadas\": 150,\n        \"aprobadas_auto\": 45,\n        \"enviadas_revision\": 105,\n        \"tasa_automatizacion\": 30.0\n    },\n    \"por_metodo\": {\n        \"comparacion_mes_anterior\": 42,\n        \"patron_recurrencia\": 3\n    }\n}\n```","operationId":"obtener_estadisticas_automatizacion_api_v1_automatizacion_estadisticas_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"dias","in":"query","required":false,"schema":{"type":"integer","maximum":365,"minimum":1,"description":"Días hacia atrás","default":30,"title":"Dias"},"description":"Días hacia atrás"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/automatizacion/facturas-pendientes":{"get":{"tags":["Automatización - Mes Anterior","Automatización"],"summary":"Listar Facturas Pendientes Procesamiento","description":"📋 Lista facturas pendientes de procesamiento automático.\n\nMuestra facturas en estado 'en_revision' o 'pendiente' que aún\nno han sido procesadas por el sistema de automatización.\n\n**Parámetros:**\n- `limite`: Número máximo de facturas a retornar (1-500)\n\n**Respuesta:**\nIncluye información de cada factura pendiente:\n- Datos básicos (número, fecha, monto)\n- Proveedor\n- Si tiene factura del mes anterior\n- Diferencia estimada de monto","operationId":"listar_facturas_pendientes_procesamiento_api_v1_automatizacion_facturas_pendientes_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"limite","in":"query","required":false,"schema":{"type":"integer","maximum":500,"minimum":1,"default":100,"title":"Limite"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/automatizacion/procesar-factura/{factura_id}":{"post":{"tags":["Automatización - Mes Anterior","Automatización"],"summary":"Procesar Factura Individual","description":"🎯 Procesa una factura individual para aprobación automática.\n\nPermite probar la automatización con una factura específica.\nÚtil para validar el comportamiento antes de procesar en lote.\n\n**Parámetros:**\n- `factura_id`: ID de la factura a procesar\n- `modo_debug`: Incluir información detallada de debug\n\n**Respuesta:**\nIncluye decisión tomada, confianza, criterios evaluados y explicación.","operationId":"procesar_factura_individual_api_v1_automatizacion_procesar_factura__factura_id__post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"factura_id","in":"path","required":true,"schema":{"type":"integer","title":"Factura Id"}},{"name":"modo_debug","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Modo Debug"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/historial-pagos/analizar-patrones":{"post":{"tags":["Historial de Pagos","Historial de Pagos"],"summary":"Ejecutar análisis de patrones desde BD","description":"Ejecuta análisis de patrones históricos desde facturas de la BD.\n\n    Este endpoint:\n    - Analiza facturas de los últimos N meses\n    - Calcula estadísticas por proveedor + concepto\n    - Clasifica patrones en TIPO_A/B/C\n    - Actualiza/crea registros en historial_pagos\n\n    **Uso recomendado:** Ejecutar diariamente o semanalmente vía tarea programada.","operationId":"analizar_patrones_desde_bd_api_v1_historial_pagos_analizar_patrones_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalizarPatronesRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Analizar Patrones Desde Bd Api V1 Historial Pagos Analizar Patrones Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/historial-pagos/patrones":{"get":{"tags":["Historial de Pagos","Historial de Pagos"],"summary":"Listar todos los patrones históricos","description":"Obtiene listado de patrones históricos con filtros opcionales.","operationId":"listar_patrones_api_v1_historial_pagos_patrones_get","parameters":[{"name":"proveedor_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Filtrar por proveedor","title":"Proveedor Id"},"description":"Filtrar por proveedor"},{"name":"tipo_patron","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filtrar por tipo (TIPO_A, TIPO_B, TIPO_C)","title":"Tipo Patron"},"description":"Filtrar por tipo (TIPO_A, TIPO_B, TIPO_C)"},{"name":"solo_auto_aprobables","in":"query","required":false,"schema":{"type":"boolean","description":"Solo patrones auto-aprobables","default":false,"title":"Solo Auto Aprobables"},"description":"Solo patrones auto-aprobables"},{"name":"skip","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"Registros a saltar","default":0,"title":"Skip"},"description":"Registros a saltar"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":500,"minimum":1,"description":"Cantidad de registros","default":50,"title":"Limit"},"description":"Cantidad de registros"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Listar Patrones Api V1 Historial Pagos Patrones Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/historial-pagos/estadisticas":{"get":{"tags":["Historial de Pagos","Historial de Pagos"],"summary":"Obtener estadísticas globales de patrones","description":"Retorna métricas agregadas de todos los patrones históricos.","operationId":"obtener_estadisticas_api_v1_historial_pagos_estadisticas_get","parameters":[{"name":"proveedor_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Filtrar por proveedor","title":"Proveedor Id"},"description":"Filtrar por proveedor"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Obtener Estadisticas Api V1 Historial Pagos Estadisticas Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/historial-pagos/patrones/{patron_id}":{"get":{"tags":["Historial de Pagos","Historial de Pagos"],"summary":"Obtener detalle de un patrón específico","description":"Retorna información detallada de un patrón histórico por ID.","operationId":"obtener_patron_detalle_api_v1_historial_pagos_patrones__patron_id__get","parameters":[{"name":"patron_id","in":"path","required":true,"schema":{"type":"integer","title":"Patron Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Obtener Patron Detalle Api V1 Historial Pagos Patrones  Patron Id  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/historial-pagos/proveedor/{proveedor_id}/patrones":{"get":{"tags":["Historial de Pagos","Historial de Pagos"],"summary":"Obtener todos los patrones de un proveedor","description":"Lista todos los patrones históricos asociados a un proveedor.","operationId":"obtener_patrones_proveedor_api_v1_historial_pagos_proveedor__proveedor_id__patrones_get","parameters":[{"name":"proveedor_id","in":"path","required":true,"schema":{"type":"integer","title":"Proveedor Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Obtener Patrones Proveedor Api V1 Historial Pagos Proveedor  Proveedor Id  Patrones Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/procesar-factura":{"post":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Procesar Factura Nueva","description":"Procesa una factura recién ingresada al sistema.\n\n**Flujo automático:**\n1. Identifica NIT del proveedor\n2. Asigna al responsable correspondiente\n3. Compara con factura del mes anterior\n4. Aprueba automáticamente si es idéntica\n5. Envía a revisión manual si hay diferencias\n6. Genera notificaciones","operationId":"procesar_factura_nueva_api_v1_workflow_procesar_factura_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProcesarFacturaRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/procesar-lote":{"post":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Procesar Facturas Pendientes","description":"Procesa en lote todas las facturas que aún no tienen workflow asignado.","operationId":"procesar_facturas_pendientes_api_v1_workflow_procesar_lote_post","parameters":[{"name":"limite","in":"query","required":false,"schema":{"type":"integer","description":"Máximo de facturas a procesar","default":50,"title":"Limite"},"description":"Máximo de facturas a procesar"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/aprobar/{workflow_id}":{"post":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Aprobar Factura Manual","description":"Aprueba manualmente una factura.\n\nUsar cuando la factura está en estado PENDIENTE_REVISION.","operationId":"aprobar_factura_manual_api_v1_workflow_aprobar__workflow_id__post","parameters":[{"name":"workflow_id","in":"path","required":true,"schema":{"type":"integer","title":"Workflow Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AprobacionManualRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/rechazar/{workflow_id}":{"post":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Rechazar Factura","description":"Rechaza una factura.","operationId":"rechazar_factura_api_v1_workflow_rechazar__workflow_id__post","parameters":[{"name":"workflow_id","in":"path","required":true,"schema":{"type":"integer","title":"Workflow Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RechazoRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/consultar/{workflow_id}":{"get":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Consultar Workflow","description":"Consulta el estado de un workflow específico.","operationId":"consultar_workflow_api_v1_workflow_consultar__workflow_id__get","parameters":[{"name":"workflow_id","in":"path","required":true,"schema":{"type":"integer","title":"Workflow Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/listar":{"get":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Listar Workflows","description":"Lista workflows con filtros opcionales.","operationId":"listar_workflows_api_v1_workflow_listar_get","parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"estado","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Estado"}},{"name":"responsable_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Responsable Id"}},{"name":"nit_proveedor","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Nit Proveedor"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/dashboard":{"get":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Obtener Dashboard Workflow","description":"Dashboard de seguimiento del workflow de facturas.\n\nMétricas:\n- Total facturas por estado\n- Facturas aprobadas automáticamente vs manualmente\n- Facturas pendientes de revisión\n- Tiempo promedio de aprobación\n- Facturas rechazadas","operationId":"obtener_dashboard_workflow_api_v1_workflow_dashboard_get","parameters":[{"name":"responsable_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Responsable Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/asignaciones":{"post":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Crear Asignacion Nit","description":"Crea una asignación de NIT a Responsable.\n\nConfigura qué responsable debe aprobar las facturas de un proveedor específico.","operationId":"crear_asignacion_nit_api_v1_workflow_asignaciones_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AsignacionNitRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Listar Asignaciones","description":"Lista todas las asignaciones NIT-Responsable.","operationId":"listar_asignaciones_api_v1_workflow_asignaciones_get","parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"activo","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"default":true,"title":"Activo"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/asignaciones/{asignacion_id}":{"put":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Actualizar Asignacion","description":"Actualiza una asignación NIT-Responsable.","operationId":"actualizar_asignacion_api_v1_workflow_asignaciones__asignacion_id__put","parameters":[{"name":"asignacion_id","in":"path","required":true,"schema":{"type":"integer","title":"Asignacion Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AsignacionNitRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/notificaciones/enviar-pendientes":{"post":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Enviar Notificaciones Pendientes","description":"Envía las notificaciones pendientes en cola.","operationId":"enviar_notificaciones_pendientes_api_v1_workflow_notificaciones_enviar_pendientes_post","parameters":[{"name":"limite","in":"query","required":false,"schema":{"type":"integer","description":"Máximo de notificaciones a enviar","default":50,"title":"Limite"},"description":"Máximo de notificaciones a enviar"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/notificaciones/enviar-recordatorios":{"post":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Enviar Recordatorios","description":"Envía recordatorios para facturas pendientes de revisión hace más de X días.","operationId":"enviar_recordatorios_api_v1_workflow_notificaciones_enviar_recordatorios_post","parameters":[{"name":"dias_pendiente","in":"query","required":false,"schema":{"type":"integer","description":"Días que debe estar pendiente","default":3,"title":"Dias Pendiente"},"description":"Días que debe estar pendiente"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/mis-facturas-pendientes":{"get":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Obtener Mis Facturas Pendientes","description":"Obtiene todas las facturas pendientes de aprobación de un responsable específico.\n\nRetorna workflows en estados: PENDIENTE_REVISION, EN_ANALISIS, REQUIERE_APROBACION_MANUAL","operationId":"obtener_mis_facturas_pendientes_api_v1_workflow_mis_facturas_pendientes_get","parameters":[{"name":"responsable_id","in":"query","required":true,"schema":{"type":"integer","description":"ID del responsable","title":"Responsable Id"},"description":"ID del responsable"},{"name":"limite","in":"query","required":false,"schema":{"type":"integer","description":"Límite de resultados","default":50,"title":"Limite"},"description":"Límite de resultados"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/factura-detalle/{factura_id}":{"get":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Obtener Factura Con Workflow","description":"Obtiene el detalle completo de una factura incluyendo su workflow y comparación.\n\nÚtil para mostrar toda la información en un dashboard o modal de aprobación.","operationId":"obtener_factura_con_workflow_api_v1_workflow_factura_detalle__factura_id__get","parameters":[{"name":"factura_id","in":"path","required":true,"schema":{"type":"integer","title":"Factura Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/analizar-patrones/{proveedor_id}":{"post":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Analizar Patron Proveedor","description":"Analiza el patrón histórico de pagos para un proveedor y concepto específico.\n\nGenera estadísticas y clasificación (Tipo A, B, C) basado en los últimos 12 meses.","operationId":"analizar_patron_proveedor_api_v1_workflow_analizar_patrones__proveedor_id__post","parameters":[{"name":"proveedor_id","in":"path","required":true,"schema":{"type":"integer","title":"Proveedor Id"}},{"name":"concepto","in":"query","required":true,"schema":{"type":"string","description":"Concepto normalizado a analizar","title":"Concepto"},"description":"Concepto normalizado a analizar"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/regenerar-patrones":{"post":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Regenerar Todos Patrones","description":"Regenera todos los patrones históricos del sistema.\n\nÚtil para:\n- Inicialización del sistema\n- Recalibración después de cambios en algoritmo\n- Actualización masiva de patrones","operationId":"regenerar_todos_patrones_api_v1_workflow_regenerar_patrones_post","parameters":[{"name":"limit","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Límite de combinaciones a procesar","title":"Limit"},"description":"Límite de combinaciones a procesar"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/comparar-factura-items/{factura_id}":{"post":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Comparar Factura Items","description":"🔬 **ENDPOINT ENTERPRISE: Comparación Granular Item por Item**\n\nAnaliza una factura comparando cada item contra su historial mensual.\n\n**Funcionalidad:**\n- Compara item por item vs histórico del proveedor\n- Detecta variaciones de precio unitario (umbrales: 15% moderado, 30% alto)\n- Detecta variaciones de cantidad (umbrales: 20% moderado, 50% alto)\n- Identifica items nuevos sin historial\n- Genera alertas con severidad (baja/media/alta)\n- Calcula confianza para aprobación automática (0-100%)\n\n**Retorna:**\n- Análisis detallado de cada item\n- Alertas organizadas por severidad\n- Recomendación de aprobación (aprobar_auto / en_revision)\n- Porcentaje de confianza\n\n**Uso:**\n- Verificación manual antes de aprobar factura\n- Auditoría de facturas ya procesadas\n- Análisis de proveedores con cambios frecuentes","operationId":"comparar_factura_items_api_v1_workflow_comparar_factura_items__factura_id__post","parameters":[{"name":"factura_id","in":"path","required":true,"schema":{"type":"integer","title":"Factura Id"}},{"name":"meses_historico","in":"query","required":false,"schema":{"type":"integer","description":"Meses de historial a analizar","default":12,"title":"Meses Historico"},"description":"Meses de historial a analizar"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/workflow/estadisticas-comparacion":{"get":{"tags":["Workflow Aprobación","Workflow Aprobación"],"summary":"Obtener Estadisticas Comparacion","description":"📊 **Estadísticas del Sistema de Comparación de Items**\n\nRetorna métricas globales del sistema de comparación automática.\n\n**Métricas:**\n- Total de facturas analizadas\n- Tasa de aprobación automática\n- Alertas más comunes\n- Proveedores con más variaciones\n- Tendencias de precios","operationId":"obtener_estadisticas_comparacion_api_v1_workflow_estadisticas_comparacion_get","parameters":[{"name":"fecha_desde","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Fecha inicio (YYYY-MM-DD)","title":"Fecha Desde"},"description":"Fecha inicio (YYYY-MM-DD)"},{"name":"fecha_hasta","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Fecha fin (YYYY-MM-DD)","title":"Fecha Hasta"},"description":"Fecha fin (YYYY-MM-DD)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/responsable-proveedor/":{"get":{"tags":["Responsable-Proveedor","Responsable-Proveedor"],"summary":"Listar Asignaciones","description":"Lista todas las asignaciones de responsable-proveedor.\n\nFiltros opcionales:\n- responsable_id: Filtrar por responsable\n- proveedor_id: Filtrar por proveedor\n- activo: Filtrar por estado activo/inactivo","operationId":"listar_asignaciones_api_v1_responsable_proveedor__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"responsable_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Responsable Id"}},{"name":"proveedor_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Proveedor Id"}},{"name":"activo","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Activo"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AsignacionResponse"},"title":"Response Listar Asignaciones Api V1 Responsable Proveedor  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Responsable-Proveedor","Responsable-Proveedor"],"summary":"Crear Asignacion","description":"Crea una nueva asignación de responsable a proveedor.\nSolo administradores pueden crear asignaciones.","operationId":"crear_asignacion_api_v1_responsable_proveedor__post","security":[{"OAuth2PasswordBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AsignacionCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/responsable-proveedor/{asignacion_id}":{"get":{"tags":["Responsable-Proveedor","Responsable-Proveedor"],"summary":"Obtener Asignacion","description":"Obtiene una asignación específica por ID.","operationId":"obtener_asignacion_api_v1_responsable_proveedor__asignacion_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"asignacion_id","in":"path","required":true,"schema":{"type":"integer","title":"Asignacion Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AsignacionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Responsable-Proveedor","Responsable-Proveedor"],"summary":"Actualizar Asignacion","description":"Actualiza una asignación existente.\nPermite cambiar el responsable o el estado activo.","operationId":"actualizar_asignacion_api_v1_responsable_proveedor__asignacion_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"asignacion_id","in":"path","required":true,"schema":{"type":"integer","title":"Asignacion Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AsignacionUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Responsable-Proveedor","Responsable-Proveedor"],"summary":"Eliminar Asignacion","description":"Elimina una asignación de responsable-proveedor.\nSolo administradores pueden eliminar asignaciones.","operationId":"eliminar_asignacion_api_v1_responsable_proveedor__asignacion_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"asignacion_id","in":"path","required":true,"schema":{"type":"integer","title":"Asignacion Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/responsable-proveedor/bulk":{"post":{"tags":["Responsable-Proveedor","Responsable-Proveedor"],"summary":"Crear Asignaciones Masivas","description":"Crea múltiples asignaciones de un responsable a varios proveedores.\nÚtil para asignación masiva.","operationId":"crear_asignaciones_masivas_api_v1_responsable_proveedor_bulk_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AsignacionBulkCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/responsable-proveedor/proveedor/{proveedor_id}/responsables":{"get":{"tags":["Responsable-Proveedor","Responsable-Proveedor"],"summary":"Obtener Responsables De Proveedor","description":"Obtiene todos los responsables asignados a un proveedor.","operationId":"obtener_responsables_de_proveedor_api_v1_responsable_proveedor_proveedor__proveedor_id__responsables_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"proveedor_id","in":"path","required":true,"schema":{"type":"integer","title":"Proveedor Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/responsable-proveedor/responsable/{responsable_id}/proveedores":{"get":{"tags":["Responsable-Proveedor","Responsable-Proveedor"],"summary":"Obtener Proveedores De Responsable","description":"Obtiene todos los proveedores asignados a un responsable.","operationId":"obtener_proveedores_de_responsable_api_v1_responsable_proveedor_responsable__responsable_id__proveedores_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"responsable_id","in":"path","required":true,"schema":{"type":"integer","title":"Responsable Id"}},{"name":"activo","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Activo"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/flujo-automatizacion/ejecutar-flujo-completo":{"post":{"tags":["Flujo de Automatización","Flujo de Automatización"],"summary":"Ejecutar flujo completo de automatización","description":"Ejecuta el flujo completo de automatización mensual de facturas:\n\n    **Pasos del flujo:**\n    1. Análisis de patrones históricos\n    2. Comparación de facturas pendientes con patrones\n    3. Aprobación automática o marcado para revisión\n    4. Envío de notificaciones a responsables\n\n    **Uso recomendado:**\n    - Ejecutar mensualmente después de marcar las facturas como pagadas\n    - Puede ejecutarse manualmente o mediante tarea programada","operationId":"ejecutar_flujo_completo_api_v1_flujo_automatizacion_ejecutar_flujo_completo_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EjecutarFlujoRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Ejecutar Flujo Completo Api V1 Flujo Automatizacion Ejecutar Flujo Completo Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/flujo-automatizacion/marcar-facturas-pagadas":{"post":{"tags":["Flujo de Automatización","Flujo de Automatización"],"summary":"Marcar facturas específicas como pagadas","description":"Marca facturas específicas como pagadas en la BD.\n\n    **Proceso:**\n    1. Recibe lista de IDs de facturas\n    2. Marca cada factura con estado \"pagada\"\n    3. Opcionalmente registra fecha de pago\n    4. Retorna resumen de facturas procesadas","operationId":"marcar_facturas_pagadas_api_v1_flujo_automatizacion_marcar_facturas_pagadas_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MarcarFacturasPagadasRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Marcar Facturas Pagadas Api V1 Flujo Automatizacion Marcar Facturas Pagadas Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/flujo-automatizacion/marcar-periodo-pagadas":{"post":{"tags":["Flujo de Automatización","Flujo de Automatización"],"summary":"Marcar todas las facturas de un período como pagadas","description":"Marca todas las facturas de un período específico como pagadas.\n\n    **Proceso:**\n    1. Busca todas las facturas pendientes del período\n    2. Opcionalmente filtra por proveedores específicos\n    3. Marca todas como pagadas\n    4. Retorna resumen de facturas procesadas","operationId":"marcar_periodo_pagadas_api_v1_flujo_automatizacion_marcar_periodo_pagadas_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MarcarPeriodoPagadasRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Marcar Periodo Pagadas Api V1 Flujo Automatizacion Marcar Periodo Pagadas Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/flujo-automatizacion/comparar-aprobar":{"post":{"tags":["Flujo de Automatización","Flujo de Automatización"],"summary":"Comparar y aprobar facturas pendientes","description":"Compara facturas pendientes con patrones históricos y decide aprobación.\n\n    **Lógica de decisión:**\n    1. Para cada factura pendiente, busca su patrón histórico (proveedor + concepto)\n    2. Si el patrón es auto-aprobable (TIPO_A o TIPO_B elegible):\n       - Calcula desviación del monto actual vs promedio histórico\n       - Si está dentro del umbral → Aprueba automáticamente\n       - Si excede umbral → Marca para revisión manual\n    3. Si no hay patrón histórico → Marca para revisión manual\n\n    **Estados resultantes:**\n    - aprobada_auto: Factura aprobada automáticamente\n    - en_revision: Factura requiere revisión manual","operationId":"comparar_aprobar_facturas_api_v1_flujo_automatizacion_comparar_aprobar_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CompararAprobarRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Comparar Aprobar Facturas Api V1 Flujo Automatizacion Comparar Aprobar Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/flujo-automatizacion/estadisticas-flujo":{"get":{"tags":["Flujo de Automatización","Flujo de Automatización"],"summary":"Obtener estadísticas del flujo","description":"Retorna estadísticas del flujo de automatización.\n\n    Incluye:\n    - Total de facturas procesadas\n    - Facturas aprobadas automáticamente\n    - Facturas que requieren revisión\n    - Tasa de automatización\n    - Notificaciones enviadas","operationId":"obtener_estadisticas_flujo_api_v1_flujo_automatizacion_estadisticas_flujo_get","parameters":[{"name":"periodo","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Período en formato YYYY-MM","title":"Periodo"},"description":"Período en formato YYYY-MM"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Obtener Estadisticas Flujo Api V1 Flujo Automatizacion Estadisticas Flujo Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/email-config/cuentas":{"get":{"tags":["Email Configuration","Email Configuration"],"summary":"Listar Cuentas Correo","description":"Lista todas las cuentas de correo configuradas.\n\n**Filtros:**\n- `solo_activas`: Solo cuentas activas\n- `organizacion`: Filtrar por organización","operationId":"listar_cuentas_correo_api_v1_email_config_cuentas_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","minimum":0,"default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":500,"minimum":1,"default":100,"title":"Limit"}},{"name":"solo_activas","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Solo Activas"}},{"name":"organizacion","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Organizacion"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CuentaCorreoSummary"},"title":"Response Listar Cuentas Correo Api V1 Email Config Cuentas Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Email Configuration","Email Configuration"],"summary":"Crear Cuenta Correo","description":"Crea una nueva cuenta de correo para extracción.\n\n**Validaciones:**\n- El email debe ser único\n- NITs deben ser válidos (solo números)\n- No se permiten NITs duplicados en la lista inicial","operationId":"crear_cuenta_correo_api_v1_email_config_cuentas_post","security":[{"OAuth2PasswordBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CuentaCorreoCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CuentaCorreoResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/email-config/cuentas/{cuenta_id}":{"get":{"tags":["Email Configuration","Email Configuration"],"summary":"Obtener Cuenta Correo","description":"Obtiene detalles completos de una cuenta de correo incluyendo todos sus NITs.","operationId":"obtener_cuenta_correo_api_v1_email_config_cuentas__cuenta_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"cuenta_id","in":"path","required":true,"schema":{"type":"integer","title":"Cuenta Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CuentaCorreoResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Email Configuration","Email Configuration"],"summary":"Actualizar Cuenta Correo","description":"Actualiza configuración de una cuenta de correo.","operationId":"actualizar_cuenta_correo_api_v1_email_config_cuentas__cuenta_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"cuenta_id","in":"path","required":true,"schema":{"type":"integer","title":"Cuenta Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CuentaCorreoUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CuentaCorreoResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Email Configuration","Email Configuration"],"summary":"Eliminar Cuenta Correo","description":"Elimina una cuenta de correo y todos sus NITs asociados.\n\n**ADVERTENCIA:** Esta operación es irreversible.","operationId":"eliminar_cuenta_correo_api_v1_email_config_cuentas__cuenta_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"cuenta_id","in":"path","required":true,"schema":{"type":"integer","title":"Cuenta Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/email-config/cuentas/{cuenta_id}/toggle-activa":{"post":{"tags":["Email Configuration","Email Configuration"],"summary":"Toggle Cuenta Activa","description":"Activa o desactiva una cuenta de correo.","operationId":"toggle_cuenta_activa_api_v1_email_config_cuentas__cuenta_id__toggle_activa_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"cuenta_id","in":"path","required":true,"schema":{"type":"integer","title":"Cuenta Id"}},{"name":"activa","in":"query","required":true,"schema":{"type":"boolean","description":"True para activar, False para desactivar","title":"Activa"},"description":"True para activar, False para desactivar"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CuentaCorreoResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/email-config/nits/cuenta/{cuenta_id}":{"get":{"tags":["Email Configuration","Email Configuration"],"summary":"Listar Nits Por Cuenta","description":"Lista todos los NITs configurados en una cuenta.","operationId":"listar_nits_por_cuenta_api_v1_email_config_nits_cuenta__cuenta_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"cuenta_id","in":"path","required":true,"schema":{"type":"integer","title":"Cuenta Id"}},{"name":"solo_activos","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Solo Activos"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/NitConfiguracionResponse"},"title":"Response Listar Nits Por Cuenta Api V1 Email Config Nits Cuenta  Cuenta Id  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/email-config/nits":{"post":{"tags":["Email Configuration","Email Configuration"],"summary":"Crear Nit","description":"Agrega un nuevo NIT a una cuenta de correo.\n\n**Validaciones:**\n- La cuenta debe existir\n- El NIT no puede estar duplicado en la misma cuenta\n- El NIT debe ser válido (solo números, 5-20 dígitos)","operationId":"crear_nit_api_v1_email_config_nits_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NitConfiguracionCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NitConfiguracionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/email-config/nits/bulk":{"post":{"tags":["Email Configuration","Email Configuration"],"summary":"Crear Nits Bulk","description":"Agrega múltiples NITs a una cuenta de correo en una sola operación.\n\n**Manejo de duplicados:**\n- Los NITs duplicados se ignoran y se reportan\n- La operación es atómica: se agregan todos los NITs válidos no duplicados","operationId":"crear_nits_bulk_api_v1_email_config_nits_bulk_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkNitsCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkNitsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/email-config/nits/{nit_id}":{"put":{"tags":["Email Configuration","Email Configuration"],"summary":"Actualizar Nit","description":"Actualiza información de un NIT.","operationId":"actualizar_nit_api_v1_email_config_nits__nit_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"nit_id","in":"path","required":true,"schema":{"type":"integer","title":"Nit Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NitConfiguracionUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NitConfiguracionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Email Configuration","Email Configuration"],"summary":"Eliminar Nit","description":"Elimina un NIT de una cuenta.","operationId":"eliminar_nit_api_v1_email_config_nits__nit_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"nit_id","in":"path","required":true,"schema":{"type":"integer","title":"Nit Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/email-config/nits/{nit_id}/toggle-activo":{"post":{"tags":["Email Configuration","Email Configuration"],"summary":"Toggle Nit Activo","description":"Activa o desactiva un NIT.","operationId":"toggle_nit_activo_api_v1_email_config_nits__nit_id__toggle_activo_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"nit_id","in":"path","required":true,"schema":{"type":"integer","title":"Nit Id"}},{"name":"activo","in":"query","required":true,"schema":{"type":"boolean","description":"True para activar, False para desactivar","title":"Activo"},"description":"True para activar, False para desactivar"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NitConfiguracionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/email-config/historial/cuenta/{cuenta_id}":{"get":{"tags":["Email Configuration","Email Configuration"],"summary":"Obtener Historial Extraccion","description":"Obtiene historial de extracciones de una cuenta.","operationId":"obtener_historial_extraccion_api_v1_email_config_historial_cuenta__cuenta_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"cuenta_id","in":"path","required":true,"schema":{"type":"integer","title":"Cuenta Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"default":50,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/HistorialExtraccionResponse"},"title":"Response Obtener Historial Extraccion Api V1 Email Config Historial Cuenta  Cuenta Id  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/email-config/estadisticas/cuenta/{cuenta_id}":{"get":{"tags":["Email Configuration","Email Configuration"],"summary":"Obtener Estadisticas Cuenta","description":"Obtiene estadísticas de extracción de una cuenta.","operationId":"obtener_estadisticas_cuenta_api_v1_email_config_estadisticas_cuenta__cuenta_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"cuenta_id","in":"path","required":true,"schema":{"type":"integer","title":"Cuenta Id"}},{"name":"dias","in":"query","required":false,"schema":{"type":"integer","maximum":365,"minimum":1,"description":"Días hacia atrás para estadísticas","default":30,"title":"Dias"},"description":"Días hacia atrás para estadísticas"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EstadisticasExtraccion"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/email-config/configuracion-extractor":{"get":{"tags":["Email Configuration","Email Configuration"],"summary":"Obtener Configuracion Para Extractor","description":"Obtiene configuración en formato JSON para el invoice_extractor.\n\n**Formato compatible con el JSON actual:**\n```json\n{\n  \"users\": [\n    {\n      \"email\": \"facturacion@empresa.com\",\n      \"nits\": [\"123456\", \"789012\"],\n      \"fetch_limit\": 500,\n      \"fetch_days\": 90\n    }\n  ]\n}\n```\n\nSolo incluye cuentas activas con NITs activos.","operationId":"obtener_configuracion_para_extractor_api_v1_email_config_configuracion_extractor_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfiguracionExtractorResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}}},"components":{"schemas":{"AnalizarPatronesRequest":{"properties":{"ventana_meses":{"type":"integer","maximum":24.0,"minimum":1.0,"title":"Ventana Meses","description":"Meses hacia atrás a analizar","default":12},"solo_proveedores":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"title":"Solo Proveedores","description":"IDs de proveedores a analizar"},"forzar_recalculo":{"type":"boolean","title":"Forzar Recalculo","description":"Forzar recálculo de patrones existentes","default":false}},"type":"object","title":"AnalizarPatronesRequest","description":"Request para análisis de patrones."},"AprobacionManualRequest":{"properties":{"aprobado_por":{"type":"string","title":"Aprobado Por"},"observaciones":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Observaciones"}},"type":"object","required":["aprobado_por"],"title":"AprobacionManualRequest"},"AsignacionBulkCreate":{"properties":{"responsable_id":{"type":"integer","title":"Responsable Id"},"proveedor_ids":{"items":{"type":"integer"},"type":"array","title":"Proveedor Ids"},"activo":{"type":"boolean","title":"Activo","default":true}},"type":"object","required":["responsable_id","proveedor_ids"],"title":"AsignacionBulkCreate","description":"Para asignar múltiples proveedores a un responsable"},"AsignacionCreate":{"properties":{"responsable_id":{"type":"integer","title":"Responsable Id"},"proveedor_id":{"type":"integer","title":"Proveedor Id"},"activo":{"type":"boolean","title":"Activo","default":true}},"type":"object","required":["responsable_id","proveedor_id"],"title":"AsignacionCreate"},"AsignacionNitRequest":{"properties":{"nit":{"type":"string","title":"Nit"},"nombre_proveedor":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Nombre Proveedor"},"responsable_id":{"type":"integer","title":"Responsable Id"},"area":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Area"},"permitir_aprobacion_automatica":{"type":"boolean","title":"Permitir Aprobacion Automatica","default":true},"requiere_revision_siempre":{"type":"boolean","title":"Requiere Revision Siempre","default":false},"monto_maximo_auto_aprobacion":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Monto Maximo Auto Aprobacion"},"porcentaje_variacion_permitido":{"type":"number","title":"Porcentaje Variacion Permitido","default":5.0},"emails_notificacion":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Emails Notificacion"}},"type":"object","required":["nit","responsable_id"],"title":"AsignacionNitRequest"},"AsignacionResponse":{"properties":{"id":{"type":"integer","title":"Id"},"responsable_id":{"type":"integer","title":"Responsable Id"},"proveedor_id":{"type":"integer","title":"Proveedor Id"},"activo":{"type":"boolean","title":"Activo"},"creado_en":{"type":"string","title":"Creado En"},"responsable":{"additionalProperties":true,"type":"object","title":"Responsable"},"proveedor":{"additionalProperties":true,"type":"object","title":"Proveedor"}},"type":"object","required":["id","responsable_id","proveedor_id","activo","creado_en","responsable","proveedor"],"title":"AsignacionResponse"},"AsignacionUpdate":{"properties":{"responsable_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Responsable Id"},"activo":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Activo"}},"type":"object","title":"AsignacionUpdate"},"BulkNitsCreate":{"properties":{"cuenta_correo_id":{"type":"integer","exclusiveMinimum":0.0,"title":"Cuenta Correo Id"},"nits":{"items":{"type":"string"},"type":"array","minItems":1,"title":"Nits","description":"Lista de NITs a agregar"},"creado_por":{"type":"string","maxLength":100,"minLength":1,"title":"Creado Por"}},"type":"object","required":["cuenta_correo_id","nits","creado_por"],"title":"BulkNitsCreate","description":"Schema para agregar múltiples NITs a una cuenta"},"BulkNitsResponse":{"properties":{"cuenta_correo_id":{"type":"integer","title":"Cuenta Correo Id"},"nits_agregados":{"type":"integer","title":"Nits Agregados"},"nits_duplicados":{"type":"integer","title":"Nits Duplicados"},"nits_fallidos":{"type":"integer","title":"Nits Fallidos"},"detalles":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Detalles"}},"type":"object","required":["cuenta_correo_id","nits_agregados","nits_duplicados","nits_fallidos","detalles"],"title":"BulkNitsResponse","description":"Respuesta de operación bulk"},"ClienteBase":{"properties":{"nit":{"type":"string","title":"Nit"},"razon_social":{"type":"string","title":"Razon Social"},"contacto_email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Contacto Email"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Telefono"},"direccion":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Direccion"}},"type":"object","required":["nit","razon_social","contacto_email","telefono","direccion"],"title":"ClienteBase"},"ClienteRead":{"properties":{"nit":{"type":"string","title":"Nit"},"razon_social":{"type":"string","title":"Razon Social"},"contacto_email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Contacto Email"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Telefono"},"direccion":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Direccion"},"id":{"type":"integer","title":"Id"}},"type":"object","required":["nit","razon_social","contacto_email","telefono","direccion","id"],"title":"ClienteRead"},"CompararAprobarRequest":{"properties":{"periodo_analisis":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Periodo Analisis","description":"Período a analizar en formato YYYY-MM"},"solo_proveedores":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"title":"Solo Proveedores","description":"IDs de proveedores específicos"}},"type":"object","title":"CompararAprobarRequest","description":"Request para comparación y aprobación."},"ConfiguracionExtractorEmail":{"properties":{"email":{"type":"string","title":"Email"},"nits":{"items":{"type":"string"},"type":"array","title":"Nits"},"fetch_limit":{"type":"integer","title":"Fetch Limit"},"fetch_days":{"type":"integer","title":"Fetch Days"}},"type":"object","required":["email","nits","fetch_limit","fetch_days"],"title":"ConfiguracionExtractorEmail","description":"Configuración usada por el invoice_extractor para Microsoft Graph.\nFormato compatible con el JSON actual."},"ConfiguracionExtractorResponse":{"properties":{"users":{"items":{"$ref":"#/components/schemas/ConfiguracionExtractorEmail"},"type":"array","title":"Users"},"total_cuentas":{"type":"integer","title":"Total Cuentas"},"total_nits":{"type":"integer","title":"Total Nits"},"generado_en":{"type":"string","format":"date-time","title":"Generado En"}},"type":"object","required":["users","total_cuentas","total_nits","generado_en"],"title":"ConfiguracionExtractorResponse","description":"Respuesta con todas las configuraciones activas para el extractor"},"CuentaCorreoCreate":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"Email corporativo (Microsoft Graph)"},"nombre_descriptivo":{"anyOf":[{"type":"string","maxLength":255},{"type":"null"}],"title":"Nombre Descriptivo","description":"Nombre amigable"},"fetch_limit":{"type":"integer","maximum":1000.0,"minimum":1.0,"title":"Fetch Limit","description":"Límite de correos a extraer (1-1000)","default":500},"fetch_days":{"type":"integer","maximum":365.0,"minimum":1.0,"title":"Fetch Days","description":"Días hacia atrás para buscar (1-365)","default":90},"activa":{"type":"boolean","title":"Activa","description":"Si está activa para extracción","default":true},"organizacion":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Organizacion","description":"Organización asociada"},"creada_por":{"type":"string","maxLength":100,"minLength":1,"title":"Creada Por","description":"Usuario que crea la configuración"},"nits":{"items":{"type":"string"},"type":"array","title":"Nits","description":"Lista de NITs a agregar inicialmente"}},"type":"object","required":["email","creada_por"],"title":"CuentaCorreoCreate","description":"Schema para crear una cuenta de correo"},"CuentaCorreoResponse":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"Email corporativo (Microsoft Graph)"},"nombre_descriptivo":{"anyOf":[{"type":"string","maxLength":255},{"type":"null"}],"title":"Nombre Descriptivo","description":"Nombre amigable"},"fetch_limit":{"type":"integer","maximum":1000.0,"minimum":1.0,"title":"Fetch Limit","description":"Límite de correos a extraer (1-1000)","default":500},"fetch_days":{"type":"integer","maximum":365.0,"minimum":1.0,"title":"Fetch Days","description":"Días hacia atrás para buscar (1-365)","default":90},"activa":{"type":"boolean","title":"Activa","description":"Si está activa para extracción","default":true},"organizacion":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Organizacion","description":"Organización asociada"},"id":{"type":"integer","title":"Id"},"creada_en":{"type":"string","format":"date-time","title":"Creada En"},"actualizada_en":{"type":"string","format":"date-time","title":"Actualizada En"},"creada_por":{"type":"string","title":"Creada Por"},"actualizada_por":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Actualizada Por"},"nits":{"items":{"$ref":"#/components/schemas/NitConfiguracionResponse"},"type":"array","title":"Nits","default":[]}},"type":"object","required":["email","id","creada_en","actualizada_en","creada_por","actualizada_por"],"title":"CuentaCorreoResponse","description":"Schema de respuesta con información completa de la cuenta"},"CuentaCorreoSummary":{"properties":{"id":{"type":"integer","title":"Id"},"email":{"type":"string","title":"Email"},"nombre_descriptivo":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Nombre Descriptivo"},"activa":{"type":"boolean","title":"Activa"},"organizacion":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Organizacion"},"total_nits":{"type":"integer","title":"Total Nits","description":"Cantidad de NITs configurados"},"total_nits_activos":{"type":"integer","title":"Total Nits Activos","description":"Cantidad de NITs activos"},"creada_en":{"type":"string","format":"date-time","title":"Creada En"}},"type":"object","required":["id","email","nombre_descriptivo","activa","organizacion","total_nits","total_nits_activos","creada_en"],"title":"CuentaCorreoSummary","description":"Resumen de cuenta de correo (sin NITs)"},"CuentaCorreoUpdate":{"properties":{"nombre_descriptivo":{"anyOf":[{"type":"string","maxLength":255},{"type":"null"}],"title":"Nombre Descriptivo"},"fetch_limit":{"anyOf":[{"type":"integer","maximum":1000.0,"minimum":1.0},{"type":"null"}],"title":"Fetch Limit"},"fetch_days":{"anyOf":[{"type":"integer","maximum":365.0,"minimum":1.0},{"type":"null"}],"title":"Fetch Days"},"activa":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Activa"},"organizacion":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Organizacion"},"actualizada_por":{"type":"string","maxLength":100,"minLength":1,"title":"Actualizada Por"}},"type":"object","required":["actualizada_por"],"title":"CuentaCorreoUpdate","description":"Schema para actualizar una cuenta de correo"},"CursorPaginatedResponse_FacturaRead_":{"properties":{"data":{"items":{"$ref":"#/components/schemas/FacturaRead"},"type":"array","title":"Data","description":"Lista de registros"},"cursor":{"$ref":"#/components/schemas/CursorPaginationMetadata","description":"Metadata de cursor"}},"type":"object","required":["data","cursor"],"title":"CursorPaginatedResponse[FacturaRead]","example":{"cursor":{"count":500,"has_more":true,"next_cursor":"MjAyNS0xMC0wOFQxMDowMDowMHwxMjM0NQ=="},"data":["...lista de objetos..."]}},"CursorPaginationMetadata":{"properties":{"has_more":{"type":"boolean","title":"Has More","description":"Indica si hay más registros disponibles"},"next_cursor":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Next Cursor","description":"Cursor para la siguiente página"},"prev_cursor":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Prev Cursor","description":"Cursor para la página anterior"},"count":{"type":"integer","title":"Count","description":"Cantidad de registros retornados en esta respuesta"}},"type":"object","required":["has_more","count"],"title":"CursorPaginationMetadata","description":"Metadata para cursor-based pagination (escalable para millones de registros)","example":{"count":500,"has_more":true,"next_cursor":"MjAyNS0xMC0wOFQxMDowMDowMHwxMjM0NQ=="}},"EjecutarFlujoRequest":{"properties":{"periodo_analisis":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Periodo Analisis","description":"Período a analizar en formato YYYY-MM. Si no se especifica, usa el mes actual"},"solo_proveedores":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"title":"Solo Proveedores","description":"IDs de proveedores específicos a procesar. Si no se especifica, procesa todos"}},"type":"object","title":"EjecutarFlujoRequest","description":"Request para ejecutar el flujo completo."},"ErrorResponse":{"properties":{"detail":{"type":"string","title":"Detail"}},"type":"object","required":["detail"],"title":"ErrorResponse"},"EstadisticasAutomatizacion":{"properties":{"facturas_procesadas_hoy":{"type":"integer","title":"Facturas Procesadas Hoy"},"facturas_aprobadas_automaticamente":{"type":"integer","title":"Facturas Aprobadas Automaticamente"},"facturas_en_revision":{"type":"integer","title":"Facturas En Revision"},"tasa_automatizacion":{"type":"number","title":"Tasa Automatizacion"},"tiempo_promedio_procesamiento":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Tiempo Promedio Procesamiento"},"ultimo_procesamiento":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Ultimo Procesamiento"}},"type":"object","required":["facturas_procesadas_hoy","facturas_aprobadas_automaticamente","facturas_en_revision","tasa_automatizacion","tiempo_promedio_procesamiento","ultimo_procesamiento"],"title":"EstadisticasAutomatizacion","description":"Esquema para estadísticas de automatización."},"EstadisticasExtraccion":{"properties":{"cuenta_correo_id":{"type":"integer","title":"Cuenta Correo Id"},"email":{"type":"string","title":"Email"},"total_ejecuciones":{"type":"integer","title":"Total Ejecuciones"},"ultima_ejecucion":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Ultima Ejecucion"},"total_facturas_encontradas":{"type":"integer","title":"Total Facturas Encontradas"},"total_facturas_creadas":{"type":"integer","title":"Total Facturas Creadas"},"tasa_exito":{"type":"number","maximum":100.0,"minimum":0.0,"title":"Tasa Exito","description":"Porcentaje de éxito"},"promedio_tiempo_ms":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Promedio Tiempo Ms"}},"type":"object","required":["cuenta_correo_id","email","total_ejecuciones","ultima_ejecucion","total_facturas_encontradas","total_facturas_creadas","tasa_exito","promedio_tiempo_ms"],"title":"EstadisticasExtraccion","description":"Estadísticas de extracción por cuenta"},"EstadoFactura":{"type":"string","enum":["pendiente","en_revision","aprobada","rechazada","aprobada_auto"],"title":"EstadoFactura"},"FacturaCreate":{"properties":{"numero_factura":{"type":"string","title":"Numero Factura"},"fecha_emision":{"type":"string","format":"date","title":"Fecha Emision"},"proveedor_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Proveedor Id"},"subtotal":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*(?:\\d{0,13}|(?=[\\d.]{1,16}0*$)\\d{0,13}\\.\\d{0,2}0*$)"}],"title":"Subtotal"},"iva":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*(?:\\d{0,13}|(?=[\\d.]{1,16}0*$)\\d{0,13}\\.\\d{0,2}0*$)"}],"title":"Iva"},"fecha_vencimiento":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Fecha Vencimiento"},"cufe":{"type":"string","title":"Cufe"},"total_a_pagar":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*(?:\\d{0,13}|(?=[\\d.]{1,16}0*$)\\d{0,13}\\.\\d{0,2}0*$)"},{"type":"null"}],"title":"Total A Pagar"}},"type":"object","required":["numero_factura","fecha_emision","subtotal","iva","cufe"],"title":"FacturaCreate"},"FacturaRead":{"properties":{"numero_factura":{"type":"string","title":"Numero Factura"},"fecha_emision":{"type":"string","format":"date","title":"Fecha Emision"},"proveedor_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Proveedor Id"},"subtotal":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*(?:\\d{0,13}|(?=[\\d.]{1,16}0*$)\\d{0,13}\\.\\d{0,2}0*$)","title":"Subtotal"},"iva":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*(?:\\d{0,13}|(?=[\\d.]{1,16}0*$)\\d{0,13}\\.\\d{0,2}0*$)","title":"Iva"},"fecha_vencimiento":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Fecha Vencimiento"},"cufe":{"type":"string","title":"Cufe"},"total_a_pagar":{"anyOf":[{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*(?:\\d{0,13}|(?=[\\d.]{1,16}0*$)\\d{0,13}\\.\\d{0,2}0*$)"},{"type":"null"}],"title":"Total A Pagar"},"id":{"type":"integer","title":"Id"},"estado":{"$ref":"#/components/schemas/EstadoFactura"},"responsable_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Responsable Id"},"creado_en":{"type":"string","format":"date-time","title":"Creado En"},"actualizado_en":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Actualizado En"},"proveedor":{"anyOf":[{"$ref":"#/components/schemas/ProveedorSimple"},{"type":"null"}]},"nit_emisor":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Nit Emisor"},"nombre_emisor":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Nombre Emisor"},"monto_total":{"anyOf":[{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"Monto Total"},"confianza_automatica":{"anyOf":[{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"Confianza Automatica"},"factura_referencia_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Factura Referencia Id"},"motivo_decision":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Motivo Decision"},"fecha_procesamiento_auto":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Fecha Procesamiento Auto"}},"type":"object","required":["numero_factura","fecha_emision","subtotal","iva","cufe","id","estado","responsable_id","creado_en","actualizado_en"],"title":"FacturaRead"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HistorialExtraccionResponse":{"properties":{"id":{"type":"integer","title":"Id"},"cuenta_correo_id":{"type":"integer","title":"Cuenta Correo Id"},"fecha_ejecucion":{"type":"string","format":"date-time","title":"Fecha Ejecucion"},"correos_procesados":{"type":"integer","title":"Correos Procesados"},"facturas_encontradas":{"type":"integer","title":"Facturas Encontradas"},"facturas_creadas":{"type":"integer","title":"Facturas Creadas"},"facturas_actualizadas":{"type":"integer","title":"Facturas Actualizadas"},"facturas_ignoradas":{"type":"integer","title":"Facturas Ignoradas"},"exito":{"type":"boolean","title":"Exito"},"mensaje_error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Mensaje Error"},"tiempo_ejecucion_ms":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Tiempo Ejecucion Ms"},"fetch_limit_usado":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Fetch Limit Usado"},"fetch_days_usado":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Fetch Days Usado"},"nits_usados":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Nits Usados"}},"type":"object","required":["id","cuenta_correo_id","fecha_ejecucion","correos_procesados","facturas_encontradas","facturas_creadas","facturas_actualizadas","facturas_ignoradas","exito","mensaje_error","tiempo_ejecucion_ms","fetch_limit_usado","fetch_days_usado","nits_usados"],"title":"HistorialExtraccionResponse","description":"Schema de respuesta del historial"},"LoginRequest":{"properties":{"usuario":{"type":"string","title":"Usuario"},"password":{"type":"string","title":"Password"}},"type":"object","required":["usuario","password"],"title":"LoginRequest"},"MarcarFacturasPagadasRequest":{"properties":{"facturas_ids":{"items":{"type":"integer"},"type":"array","title":"Facturas Ids","description":"Lista de IDs de facturas a marcar como pagadas"},"fecha_pago":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Fecha Pago","description":"Fecha de pago en formato ISO (YYYY-MM-DD). Si no se especifica, usa fecha actual"}},"type":"object","required":["facturas_ids"],"title":"MarcarFacturasPagadasRequest","description":"Request para marcar facturas como pagadas."},"MarcarPeriodoPagadasRequest":{"properties":{"periodo":{"type":"string","title":"Periodo","description":"Período en formato YYYY-MM"},"solo_proveedores":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"title":"Solo Proveedores","description":"IDs de proveedores específicos (opcional)"}},"type":"object","required":["periodo"],"title":"MarcarPeriodoPagadasRequest","description":"Request para marcar todas las facturas de un período como pagadas."},"NitConfiguracionCreate":{"properties":{"nit":{"type":"string","maxLength":20,"minLength":5,"title":"Nit","description":"NIT del proveedor (solo números)"},"nombre_proveedor":{"anyOf":[{"type":"string","maxLength":255},{"type":"null"}],"title":"Nombre Proveedor","description":"Nombre del proveedor (opcional)"},"activo":{"type":"boolean","title":"Activo","description":"Si este NIT está activo para filtrado","default":true},"notas":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Notas"},"cuenta_correo_id":{"type":"integer","exclusiveMinimum":0.0,"title":"Cuenta Correo Id","description":"ID de la cuenta de correo"},"creado_por":{"type":"string","maxLength":100,"minLength":1,"title":"Creado Por"}},"type":"object","required":["nit","cuenta_correo_id","creado_por"],"title":"NitConfiguracionCreate","description":"Schema para crear un NIT"},"NitConfiguracionResponse":{"properties":{"nit":{"type":"string","maxLength":20,"minLength":5,"title":"Nit","description":"NIT del proveedor (solo números)"},"nombre_proveedor":{"anyOf":[{"type":"string","maxLength":255},{"type":"null"}],"title":"Nombre Proveedor","description":"Nombre del proveedor (opcional)"},"activo":{"type":"boolean","title":"Activo","description":"Si este NIT está activo para filtrado","default":true},"notas":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Notas"},"id":{"type":"integer","title":"Id"},"cuenta_correo_id":{"type":"integer","title":"Cuenta Correo Id"},"creado_en":{"type":"string","format":"date-time","title":"Creado En"},"actualizado_en":{"type":"string","format":"date-time","title":"Actualizado En"},"creado_por":{"type":"string","title":"Creado Por"},"actualizado_por":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Actualizado Por"}},"type":"object","required":["nit","id","cuenta_correo_id","creado_en","actualizado_en","creado_por","actualizado_por"],"title":"NitConfiguracionResponse","description":"Schema de respuesta con información completa del NIT"},"NitConfiguracionUpdate":{"properties":{"nombre_proveedor":{"anyOf":[{"type":"string","maxLength":255},{"type":"null"}],"title":"Nombre Proveedor"},"activo":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Activo"},"notas":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Notas"},"actualizado_por":{"type":"string","maxLength":100,"minLength":1,"title":"Actualizado Por"}},"type":"object","required":["actualizado_por"],"title":"NitConfiguracionUpdate","description":"Schema para actualizar un NIT"},"PaginatedResponse_FacturaRead_":{"properties":{"data":{"items":{"$ref":"#/components/schemas/FacturaRead"},"type":"array","title":"Data","description":"Lista de registros de la página actual"},"pagination":{"$ref":"#/components/schemas/PaginationMetadata","description":"Metadata de paginación"}},"type":"object","required":["data","pagination"],"title":"PaginatedResponse[FacturaRead]","example":{"data":["...lista de objetos..."],"pagination":{"has_next":true,"has_prev":false,"page":1,"per_page":500,"total":5420,"total_pages":11}}},"PaginationMetadata":{"properties":{"total":{"type":"integer","title":"Total","description":"Total de registros en la base de datos"},"page":{"type":"integer","minimum":1.0,"title":"Page","description":"Página actual (base 1)"},"per_page":{"type":"integer","maximum":2000.0,"minimum":1.0,"title":"Per Page","description":"Registros por página"},"total_pages":{"type":"integer","title":"Total Pages","description":"Total de páginas disponibles"},"has_next":{"type":"boolean","title":"Has Next","description":"Indica si hay página siguiente"},"has_prev":{"type":"boolean","title":"Has Prev","description":"Indica si hay página anterior"}},"type":"object","required":["total","page","per_page","total_pages","has_next","has_prev"],"title":"PaginationMetadata","description":"Metadata de paginación para respuestas empresariales","example":{"has_next":true,"has_prev":false,"page":1,"per_page":500,"total":5420,"total_pages":11}},"ProcesarFacturaRequest":{"properties":{"factura_id":{"type":"integer","title":"Factura Id"}},"type":"object","required":["factura_id"],"title":"ProcesarFacturaRequest"},"ProveedorBase":{"properties":{"nit":{"type":"string","title":"Nit"},"razon_social":{"type":"string","title":"Razon Social"},"contacto_email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Contacto Email"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Telefono"},"direccion":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Direccion"},"area":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Area"},"activo":{"type":"boolean","title":"Activo","default":true}},"type":"object","required":["nit","razon_social"],"title":"ProveedorBase"},"ProveedorRead":{"properties":{"nit":{"type":"string","title":"Nit"},"razon_social":{"type":"string","title":"Razon Social"},"contacto_email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Contacto Email"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Telefono"},"direccion":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Direccion"},"area":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Area"},"activo":{"type":"boolean","title":"Activo","default":true},"id":{"type":"integer","title":"Id"}},"type":"object","required":["nit","razon_social","id"],"title":"ProveedorRead"},"ProveedorSimple":{"properties":{"id":{"type":"integer","title":"Id"},"nit":{"type":"string","title":"Nit"},"razon_social":{"type":"string","title":"Razon Social"}},"type":"object","required":["id","nit","razon_social"],"title":"ProveedorSimple"},"RechazoRequest":{"properties":{"rechazado_por":{"type":"string","title":"Rechazado Por"},"motivo":{"type":"string","title":"Motivo"},"detalle":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Detalle"}},"type":"object","required":["rechazado_por","motivo"],"title":"RechazoRequest"},"ResponsableCreate":{"properties":{"usuario":{"type":"string","title":"Usuario","example":"juan.perez@empresa.com"},"email":{"type":"string","format":"email","title":"Email"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Nombre"},"role_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Role Id"},"password":{"type":"string","minLength":8,"title":"Password"},"area":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Area"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Telefono"}},"type":"object","required":["usuario","email","nombre","role_id","password"],"title":"ResponsableCreate"},"ResponsableProveedorAssign":{"properties":{"responsable_id":{"type":"integer","title":"Responsable Id"},"nits_proveedores":{"items":{"type":"string"},"type":"array","title":"Nits Proveedores","example":["890929073","901261003"]}},"type":"object","required":["responsable_id","nits_proveedores"],"title":"ResponsableProveedorAssign"},"ResponsableProveedorUpdate":{"properties":{"nits_proveedores":{"items":{"type":"string"},"type":"array","title":"Nits Proveedores","example":["890929073","901261003"]}},"type":"object","required":["nits_proveedores"],"title":"ResponsableProveedorUpdate"},"ResponsableRead":{"properties":{"usuario":{"type":"string","title":"Usuario","example":"juan.perez@empresa.com"},"email":{"type":"string","format":"email","title":"Email"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Nombre"},"role_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Role Id"},"id":{"type":"integer","title":"Id"},"activo":{"type":"boolean","title":"Activo"},"must_change_password":{"type":"boolean","title":"Must Change Password"},"last_login":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Login"},"creado_en":{"type":"string","format":"date-time","title":"Creado En"},"area":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Area"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Telefono"},"role":{"anyOf":[{"$ref":"#/components/schemas/app__schemas__responsable__RoleRead"},{"type":"null"}]}},"type":"object","required":["usuario","email","nombre","role_id","id","activo","must_change_password","last_login","creado_en","area","telefono"],"title":"ResponsableRead"},"ResponsableUpdate":{"properties":{"usuario":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Usuario"},"email":{"anyOf":[{"type":"string","format":"email"},{"type":"null"}],"title":"Email"},"nombre":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Nombre"},"area":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Area"},"telefono":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Telefono"},"activo":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Activo"},"role_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Role Id"},"password":{"anyOf":[{"type":"string","minLength":8},{"type":"null"}],"title":"Password"}},"type":"object","title":"ResponsableUpdate"},"ResultadoFacturaAutomatizada":{"properties":{"factura_id":{"type":"integer","title":"Factura Id"},"numero_factura":{"type":"string","title":"Numero Factura"},"decision":{"type":"string","title":"Decision"},"confianza":{"type":"number","title":"Confianza"},"motivo":{"type":"string","title":"Motivo"},"fecha_procesamiento":{"type":"string","format":"date-time","title":"Fecha Procesamiento"},"requiere_accion_manual":{"type":"boolean","title":"Requiere Accion Manual"}},"type":"object","required":["factura_id","numero_factura","decision","confianza","motivo","fecha_procesamiento","requiere_accion_manual"],"title":"ResultadoFacturaAutomatizada","description":"Esquema para resultado de factura procesada."},"SolicitudProcesamiento":{"properties":{"limite_facturas":{"type":"integer","maximum":100.0,"minimum":1.0,"title":"Limite Facturas","default":20},"modo_debug":{"type":"boolean","title":"Modo Debug","default":false},"solo_proveedor_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Solo Proveedor Id"},"forzar_reprocesamiento":{"type":"boolean","title":"Forzar Reprocesamiento","default":false}},"type":"object","title":"SolicitudProcesamiento","description":"Esquema para solicitud de procesamiento manual."},"TokenResponse":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"},"user":{"$ref":"#/components/schemas/UsuarioResponse"}},"type":"object","required":["access_token","user"],"title":"TokenResponse"},"UsuarioResponse":{"properties":{"nombre":{"type":"string","title":"Nombre"},"email":{"type":"string","format":"email","title":"Email"},"usuario":{"type":"string","title":"Usuario"},"area":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Area"},"id":{"type":"integer","title":"Id"},"rol":{"type":"string","title":"Rol"},"activo":{"type":"boolean","title":"Activo"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["nombre","email","usuario","id","rol","activo","created_at"],"title":"UsuarioResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"app__api__v1__routers__automation__ConfiguracionAutomatizacion":{"properties":{"confianza_minima_aprobacion":{"type":"number","maximum":1.0,"minimum":0.0,"title":"Confianza Minima Aprobacion","default":0.85},"dias_historico_patron":{"type":"integer","maximum":365.0,"minimum":7.0,"title":"Dias Historico Patron","default":90},"variacion_monto_permitida":{"type":"number","maximum":1.0,"minimum":0.0,"title":"Variacion Monto Permitida","default":0.1},"requiere_orden_compra":{"type":"boolean","title":"Requiere Orden Compra","default":false},"notificaciones_activas":{"type":"boolean","title":"Notificaciones Activas","default":true},"procesamiento_automatico_activo":{"type":"boolean","title":"Procesamiento Automatico Activo","default":true}},"type":"object","title":"ConfiguracionAutomatizacion","description":"Esquema para configuración de automatización."},"app__api__v1__routers__automatizacion__ConfiguracionAutomatizacion":{"properties":{"tolerancia_porcentaje":{"type":"number","maximum":100.0,"minimum":0.0,"title":"Tolerancia Porcentaje","description":"Porcentaje de tolerancia en diferencia de montos (0-100%)","default":5.0},"limite_facturas":{"type":"integer","maximum":500.0,"minimum":1.0,"title":"Limite Facturas","description":"Número máximo de facturas a procesar por ejecución","default":50},"modo_debug":{"type":"boolean","title":"Modo Debug","description":"Incluir información detallada de debug","default":false}},"type":"object","title":"ConfiguracionAutomatizacion","description":"Configuración de parámetros de automatización."},"app__schemas__responsable__RoleRead":{"properties":{"id":{"type":"integer","title":"Id"},"nombre":{"type":"string","title":"Nombre"}},"type":"object","required":["id","nombre"],"title":"RoleRead"},"app__schemas__role__RoleRead":{"properties":{"nombre":{"type":"string","title":"Nombre"},"id":{"type":"integer","title":"Id"}},"type":"object","required":["nombre","id"],"title":"RoleRead"}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"/api/v1/auth/login"}}}}}}